<!DOCTYPE html>
<html lang="fr">
<head>
  <%- include('./common/head') %>
<!-- Bootstrap CSS -->
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">

<!-- Bootstrap JS (optional, required for some Bootstrap components) -->
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
  <title><%= stage.Titre %></title>

  <style>
  

  

    .job-details h2 {
      margin-top: 0;

    }

    .job-details p {
      margin-bottom: 5px;
    }
    .job-details {
    border: 1px solid #ccc;
    font-size: 20px;
    padding: 20px;
    margin: 20px;
    background-color: rgb(234, 234, 234);
    background-color: #ffffff;
    border-radius: 10px;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
    padding: 2rem;
    margin-bottom: 2rem;
  }

  .job-title {
    font-size: 1.8rem;
    color: #2c3e50;
    text-transform: uppercase;
    margin-bottom: 1rem;
    text-align: center; /* Center the job title */
  }

   .job-location {
    font-size: 1rem;
    color: #7f8c8d;
    margin-left: 1rem;
    display: block; /* Ensure the location appears on a new line */
    text-align: center; /* Center the location */
  }
      
      .company-name {
        font-size: 1.5rem;
        font-weight: bold;
        color: #34495e;
        margin-bottom: 0.5rem;
      }
      
      .job-location-full {
        font-size: 1.1rem;
        color: #7f8c8d;
        margin-bottom: 0.5rem;
      }
      
      .job-duration {
        font-size: 1rem;
        color: #95a5a6;
        margin-bottom: 1rem;
      }
      
      .fancy-hr {
        border: 0;
        height: 3px;
        background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));
        margin: 1.5rem 0;
      }
   
      .job-info-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1rem;
        margin-bottom: 1rem;
      }
      
      .job-info-grid p {
        margin: 0;
        font-size: 1rem;
        color: #34495e;
      }
      
      .contact-info p {
        margin-bottom: 0.5rem;
        font-size: 1rem;
        color: #34495e;
      }
      
      .email-link {
        color:#4A90E2;
        text-decoration: none;
        transition: color 0.3s ease;
      }
      
      .email-link:hover {
        color: #f60808;
        text-decoration: underline;
      }
      
      .job-description h4 {
        font-size: 1.3rem;
        color: #2c3e50;
        margin-bottom: 1rem;
      }
      
      .job-description p {
        font-size: 1rem;
        color: #34495e;
        line-height: 1.6;
      }
      
      i {
        margin-right: 0.5rem;
       
      }


  </style>
      
      <style>
        .apply-button {
         display: flex;
         align-items: center;
         justify-content: center;
         padding: 10px 20px;
         background-color: #007bff; /* Button color */
         color: white;
         border: none;
         border-radius: 5px;
         text-decoration: none;
         font-weight: bold;
         font-size: 16px;
         transition: background-color 0.3s ease, transform 0.2s ease;
         align-self: flex-end; /* Align the button to the flex-end */
     }
     
     .apply-button i {
         margin-right: 8px; /* Spacing between icon and text */
         animation: fly 2s infinite;
     }
     
     @keyframes fly {
         0% {
             transform: translateX(0);
         }
         50% {
             transform: translateX(5px);
         }
         100% {
             transform: translateX(0);
         }
     }
     
     .apply-button:hover {
         background-color: #ebf400; /* Darker shade on hover */
         transform: scale(1.05); /* Slightly enlarge the button */
     }
     
     .apply-button:active {
         background-color: #004085; /* Even darker shade on click */
         transform: scale(0.95); /* Slightly shrink the button on click */
     }
     
      </style>
</head>
<body>
  <div class="custom-container">
    <%- include('./common/sidebar') %>

    <div class="main-content">
      <%- include('./common/navbar') %>

      <a style="margin: 15px; " href="/etudiant" class="btn btn-outline-secondary">
        <i class="bi bi-arrow-left"></i> Retour
     </a>

  
     
      <hr>
      <%-include('./partial/flaskMessages') %>
     

      <div class="job-details animate__animated animate__fadeIn">
        <h3 class="job-title">
          <i class="fas fa-briefcase"></i> <%= stage.Titre %> 
          <span class="job-location"><i class="fas fa-map-marker-alt"></i> <%= stage.Address %></span>
        </h3>
        <hr class="fancy-hr">
        <h2 class="company-name"><i class="fas fa-building"></i> <%= stage.Nom %></h2>
        <p class="job-location-full"><i class="fas fa-map-pin"></i> <%= stage.Address %></p>
        <p class="job-duration">
          <i class="fas fa-calendar-alt"></i> Du <%= new Date(stage.createdAt).toLocaleString('fr-FR', { dateStyle: 'long' }) %> 
          <i class="fas fa-long-arrow-alt-right"></i> 
          Au <%= new Date(stage.DateFin).toLocaleString('fr-FR', { dateStyle: 'long' }) %>
        </p>
        <hr class="fancy-hr">
        <div class="job-info-grid">
          <p><i class="fas fa-users"></i> <strong>Postes vacants:</strong> <%= stage.PostesVacants %> poste(s) ouvert(s)</p>
          <p><i class="fas fa-star"></i> <strong>Experience :</strong> <%= stage.Experience %></p>
          <p><i class="fas fa-graduation-cap"></i> <strong>Niveau :</strong> <%= stage.Niveau %></p>
          <p><i class="fas fa-language"></i> <strong>Langue :</strong> <%= stage.Langue %></p>
        </div>
        <hr class="fancy-hr">
        <div class="contact-info">
          <p>
            <i class="fas fa-envelope"></i> <strong>Email :</strong> 
            <a href="mailto:<%= stage.Email %>" class="email-link"><%= stage.Email %></a>
            <% if (stage.Email2) { %>
              / <a href="mailto:<%= stage.Email2 %>" class="email-link"><%= stage.Email2 %></a>
            <% } %>
          </p>
          <p><i class="fas fa-phone"></i> <strong>TÃ©l :</strong> <%= stage.Telephone %></p>
          <p><i class="fas fa-fax"></i> <strong>Fax :</strong> <%= stage.Fax %></p>
        </div>
        <hr class="fancy-hr">
        <div class="job-description">
          <h4><i class="fas fa-file-alt"></i> Description de l'emploi</h4>
          <p><%= stage.Description %></p>
        </div>

        <a href="/etudiant/application/<%= stage.id %>" class="apply-button">
          <i class="fas fa-paper-plane"></i> Postuler maintenant
        </a>
      </div>


   


              <div class="domain-suggest">
                <p style="font-weight: bold; font-size:xx-large; text-align: center;padding-top: 200px; padding-bottom: 20px; color: gray;">Domaines similaires</p>
                <div id="domainCarousel" class="carousel slide" data-bs-ride="carousel">
                  <div class="carousel-inner">
                    <!-- Carousel items will be dynamically added here -->
                  </div>
                  <button class="carousel-control-prev" type="button" data-bs-target="#domainCarousel" data-bs-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="sr-only">Previous</span>
                  </button>
                  <button class="carousel-control-next" type="button" data-bs-target="#domainCarousel" data-bs-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="sr-only">Next</span>
                  </button>
                </div>
              </div>
              
             
            
  

          <%- include('./common/footer') %>
    </div>
  
  </div>

  <style>
    


.domain-card {
    background-color: #f8f9fa;
    border-radius: 10px;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }

  .domain-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
  }

  .animated-icon {
    color: #007bff;
    animation: pulse 2s infinite;
  }

  @keyframes pulse {
    0% {
      transform: scale(1);
    }
    50% {
      transform: scale(1.1);
    }
    100% {
      transform: scale(1);
    }
  }

  #domainCarousel .carousel-control-prev,
  #domainCarousel .carousel-control-next {
    width: 5%;
  }

  #domainCarousel .carousel-control-prev-icon,
  #domainCarousel .carousel-control-next-icon {
    background-color:gray;
    border-radius: 50%;
    padding: 10px;
  }
  </style>



  
    <script>
document.addEventListener('DOMContentLoaded', function() {
  const stageDomain = '<%= stage.Domaine %>'; // Get the current stage's domain

  fetch('/etudiant/domaine-suggest', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({ domaine: stageDomain }),
  })
    .then(response => response.json())
    .then(data => {
      if (data.success) {
        const similarDomains = data.domaines;
        console.log(similarDomains);
        const carouselInner = document.querySelector('#domainCarousel .carousel-inner');
        
        similarDomains.forEach((domain, index) => {
          const item = document.createElement('div');
          item.className = `carousel-item ${index === 0 ? 'active' : ''}`;
          item.innerHTML = `
            <div class="domain-card d-flex flex-column justify-content-center align-items-center p-3" style="height: 300px; cursor: pointer;" data-id="${domain.id}">
              <i class="fas fa-briefcase fa-3x mb-3 animated-icon"></i>
              <h5>${domain.Domaine}</h5>
              <p class="text-center mb-1"><strong>${domain.Nom}</strong> - ${domain.Titre}</p>
              <p class="mb-1"><i class="fas fa-user-graduate"></i> ${domain.Niveau} | <i class="fas fa-star"></i> ${domain.Experience}</p>
              <p class="mb-1"><i class="fas fa-language"></i> ${domain.Langue} | <i class="fas fa-users"></i> ${domain.PostesVacants} postes</p>
              <p class="mb-1"><i class="fas fa-calendar-alt"></i> ${new Date(domain.DateDebut).toLocaleDateString()} - ${new Date(domain.DateFin).toLocaleDateString()}</p>
              <p class="mb-1"><i class="fas fa-map-marker-alt"></i> ${domain.Address}</p>
              <p class="mb-1"><i class="fas fa-info-circle"></i> ${domain.State}</p>
            </div>
          `;
          carouselInner.appendChild(item);


          

          // Add click event to redirect to stage details
        /*   item.querySelector('.domain-card').addEventListener('click', function() {
            window.location.href = `/postulate/${this.dataset.id}`;
          }); */
          carouselInner.addEventListener('click', (event) => {
        const target = event.target.closest('.domain-card');
        if (target) {
          const id = target.getAttribute('data-id');
          const url = `/postulate/${id}`;
          window.open(url, '_blank'); // Open URL in a new tab
        }
      });
        });

      } else {
        console.error('Failed to fetch similar domains:', data.message);
      }
    })
    .catch(error => console.error('Error fetching similar domains:', error));
});


    </script>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
</body>
</html>
